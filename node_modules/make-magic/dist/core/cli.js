"use strict";var __awaiter=this&&this.__awaiter||function(e,r,o,t){return new(o||(o=Promise))((function(i,a){function n(e){try{l(t.next(e))}catch(e){a(e)}}function s(e){try{l(t.throw(e))}catch(e){a(e)}}function l(e){var r;e.done?i(e.value):(r=e.value,r instanceof o?r:new o((function(e){e(r)}))).then(n,s)}l((t=t.apply(e,r||[])).next())}))},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const fs_1=__importDefault(require("fs")),chalk_1=__importDefault(require("../compiled/chalk")),zombi_1=require("../compiled/zombi"),create_app_1=require("./create-app"),help_text_1=require("./help-text"),path_helpers_1=require("./utils/path-helpers"),errors_warnings_1=require("./utils/errors-warnings"),flags_1=require("./flags"),global_options_1=require("./global-options"),shutdown_1=require("./utils/shutdown");function sayHello(){console.log(chalk_1.default`\n
 {rgb(92,101,246) █▀▀ █}{rgb(127,103,246) ▀█ █▀▀} {rgb(133,139,247) ▄▀█ ▀█▀} {rgb(168,140,248) █▀▀}
 {rgb(92,101,246) █▄▄ █}{rgb(127,103,246) ▀▄ ██▄} {rgb(133,139,247) █▀█  █ } {rgb(168,140,248) ██▄}

 {rgb(92,101,246) █▀▄▀█} {rgb(127,103,246) ▄▀█ █▀}{rgb(133,139,247) ▀ █ █▀▀}
 {rgb(92,101,246) █ ▀ █} {rgb(127,103,246) █▀█ █▄}{rgb(133,139,247) █ █ █▄▄}

 {rgb(92,101,246) ▄▀█ █}{rgb(127,103,246) ▀█ █▀█}
 {rgb(92,101,246) █▀█ █}{rgb(127,103,246) ▀▀ █▀▀}
`),console.log(chalk_1.default`\n {dim v${getMakeMagicVersion()}}\n\n`)}function getMakeMagicVersion(){return JSON.parse(fs_1.default.readFileSync(path_helpers_1.resolveToRoot("package.json")).toString("utf8")).version}__awaiter(void 0,void 0,void 0,(function*(){shutdown_1.useGracefulShutdown();const{version:e,help:r,projectName:o,template:t,branch:i}=yield flags_1.parseFlags(global_options_1.globalOptions);e&&(console.log(getMakeMagicVersion()),process.exit(0)),r&&(sayHello(),help_text_1.printHelp(global_options_1.globalOptions,t),process.exit(0)),sayHello(),yield create_app_1.createApp({projectName:o,template:t,branch:i})})).catch((e=>{e instanceof zombi_1.ZombiError&&e.code===zombi_1.ZombiErrorCode.USER_CANCELED_PROMPT&&process.exit(1),e instanceof errors_warnings_1.CreateMagicAppError&&(console.error(`\n${e.message}`),console.error(chalk_1.default`\nSee {bold --help} for information about proper options usage.`),process.exit(1)),console.error(e),process.exit(1)}));